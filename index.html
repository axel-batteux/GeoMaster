<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoMaster - R√©visez votre G√©ographie</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
    <style>
        /* CSS Variables & Theme - Inline */
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --accent: #4cc9f0;
            --success: #2ecc71;
            --error: #e74c3c;
            --bg: #f8f9fa;
            --card: #ffffff;
            --text: #2b2d42;
            --radius: 16px;
            --font: 'Nunito', sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font);
            background-color: var(--bg);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            justify-content: center;
        }

        .app-container {
            width: 100%;
            max-width: 600px;
            background: var(--bg);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
        }

        header {
            background: var(--card);
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        h1 {
            font-size: 1.5rem;
            color: var(--primary);
        }

        #score-board {
            font-weight: 700;
            background: #eff0f5;
            padding: 0.5rem 1rem;
            border-radius: 20px;
        }

        main {
            flex: 1;
            padding: 1.5rem;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .screen {
            display: none;
            flex-direction: column;
            height: 100%;
        }

        .screen.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Menu Styles */
        .menu-grid {
            display: grid;
            gap: 1rem;
            margin-top: 2rem;
        }

        .menu-btn {
            background: var(--card);
            border: none;
            padding: 1.5rem;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            gap: 1.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
        }

        .menu-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
            background: #fff;
        }

        .menu-btn .emoji {
            font-size: 2.5rem;
        }

        .menu-btn h3 {
            font-size: 1.2rem;
            margin-bottom: 0.2rem;
        }

        .menu-btn p {
            color: #888;
            font-size: 0.9rem;
        }

        /* Game Styles */
        .question-box {
            text-align: center;
            margin-bottom: 2rem;
        }

        #question-text {
            font-size: 1.4rem;
            margin-bottom: 1rem;
        }

        #question-content img {
            max-width: 100%;
            max-height: 200px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid #eee;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .option-btn {
            background: var(--card);
            border: 2px solid transparent;
            padding: 1rem;
            border-radius: 12px;
            font-family: var(--font);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            transition: all 0.2s;
        }

        .option-btn:hover {
            border-color: var(--primary);
            background: #f0f4ff;
        }

        .option-btn.correct {
            background-color: var(--success);
            color: white;
            border-color: var(--success);
        }

        .option-btn.wrong {
            background-color: var(--error);
            color: white;
            border-color: var(--error);
        }

        /* Map Styles */
        #map-container {
            height: 400px;
            width: 100%;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 1rem;
        }

        .hidden {
            display: none !important;
        }

        #exit-btn {
            background: none;
            border: none;
            color: #888;
            text-decoration: underline;
            cursor: pointer;
        }

        footer {
            text-align: center;
            padding: 1rem;
            font-size: 0.8rem;
            color: #aaa;
        }

        .feedback {
            text-align: center;
            margin-top: 1rem;
            font-weight: 700;
            padding: 1rem;
            border-radius: 8px;
        }

        /* Response for desktop map mode */
        @media (min-width: 600px) {
            .app-container {
                max-width: 800px;
                border-right: 1px solid #eee;
                border-left: 1px solid #eee;
            }
        }
    </style>
</head>

<body>
    <div class="app-container">
        <header>
            <h1>üåç GeoMaster</h1>
            <div id="score-board" class="hidden">
                Score: <span id="current-score">0</span> / <span id="total-questions">0</span>
            </div>
            <button id="exit-btn" class="hidden">Quitter</button>
        </header>

        <main>
            <!-- Menu Screen -->
            <div id="menu-screen" class="screen active">
                <h2>Choisissez votre mode</h2>
                <div class="menu-grid">
                    <button class="menu-btn" data-mode="flags">
                        <span class="emoji">üè≥Ô∏è</span>
                        <div class="text">
                            <h3>Drapeaux</h3>
                            <p>Devinez le pays</p>
                        </div>
                    </button>
                    <button class="menu-btn" data-mode="capitals">
                        <span class="emoji">üèõÔ∏è</span>
                        <div class="text">
                            <h3>Capitales</h3>
                            <p>Trouvez la capitale</p>
                        </div>
                    </button>
                    <button class="menu-btn" data-mode="map">
                        <span class="emoji">üó∫Ô∏è</span>
                        <div class="text">
                            <h3>Localisation</h3>
                            <p>Situez sur la carte</p>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Game Screen -->
            <div id="game-screen" class="screen">
                <div id="question-container" class="question-box">
                    <h2 id="question-text">Question ici</h2>
                    <div id="question-content">
                        <!-- Flag Image or Extra info will go here -->
                    </div>
                </div>

                <!-- Multiple Choice Options -->
                <div id="options-grid" class="options-grid">
                    <!-- Buttons will be injected here -->
                </div>

                <!-- Map Container for Map Mode -->
                <div id="map-container" class="hidden"></div>

                <div id="feedback" class="feedback hidden"></div>
            </div>
        </main>

        <footer>
            <p>D√©velopp√© avec üíô par Antigravity</p>
        </footer>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
    <script>
        // Data for GeoMaster
        const countries = [
            // Europe
            { name: "Albanie", capital: "Tirana", lat: 41.3275, lng: 19.8187, flag: "https://flagcdn.com/w320/al.png" },
            { name: "Allemagne", capital: "Berlin", lat: 51.1657, lng: 10.4515, flag: "https://flagcdn.com/w320/de.png" },
            { name: "Andorre", capital: "Andorre-la-Vieille", lat: 42.5063, lng: 1.5218, flag: "https://flagcdn.com/w320/ad.png" },
            { name: "Autriche", capital: "Vienne", lat: 47.5162, lng: 14.5501, flag: "https://flagcdn.com/w320/at.png" },
            { name: "Belgique", capital: "Bruxelles", lat: 50.5039, lng: 4.4699, flag: "https://flagcdn.com/w320/be.png" },
            { name: "Bi√©lorussie", capital: "Minsk", lat: 53.7098, lng: 27.9534, flag: "https://flagcdn.com/w320/by.png" },
            { name: "Bosnie-Herz√©govine", capital: "Sarajevo", lat: 43.9159, lng: 17.6791, flag: "https://flagcdn.com/w320/ba.png" },
            { name: "Bulgarie", capital: "Sofia", lat: 42.7339, lng: 25.4858, flag: "https://flagcdn.com/w320/bg.png" },
            { name: "Chypre", capital: "Nicosie", lat: 35.1264, lng: 33.4299, flag: "https://flagcdn.com/w320/cy.png" },
            { name: "Croatie", capital: "Zagreb", lat: 45.1, lng: 15.2, flag: "https://flagcdn.com/w320/hr.png" },
            { name: "Danemark", capital: "Copenhague", lat: 56.2639, lng: 9.5018, flag: "https://flagcdn.com/w320/dk.png" },
            { name: "Espagne", capital: "Madrid", lat: 40.4637, lng: -3.7492, flag: "https://flagcdn.com/w320/es.png" },
            { name: "Estonie", capital: "Tallinn", lat: 58.5953, lng: 25.0136, flag: "https://flagcdn.com/w320/ee.png" },
            { name: "Finlande", capital: "Helsinki", lat: 61.9241, lng: 25.7482, flag: "https://flagcdn.com/w320/fi.png" },
            { name: "France", capital: "Paris", lat: 46.603354, lng: 1.888334, flag: "https://flagcdn.com/w320/fr.png" },
            { name: "Gr√®ce", capital: "Ath√®nes", lat: 39.0742, lng: 21.8243, flag: "https://flagcdn.com/w320/gr.png" },
            { name: "Hongrie", capital: "Budapest", lat: 47.1625, lng: 19.5033, flag: "https://flagcdn.com/w320/hu.png" },
            { name: "Irlande", capital: "Dublin", lat: 53.1424, lng: -7.6921, flag: "https://flagcdn.com/w320/ie.png" },
            { name: "Islande", capital: "Reykjavik", lat: 64.9631, lng: -19.0208, flag: "https://flagcdn.com/w320/is.png" },
            { name: "Italie", capital: "Rome", lat: 41.8719, lng: 12.5674, flag: "https://flagcdn.com/w320/it.png" },
            { name: "Kosovo", capital: "Pristina", lat: 42.6026, lng: 20.9030, flag: "https://flagcdn.com/w320/xk.png" },
            { name: "Lettonie", capital: "Riga", lat: 56.8796, lng: 24.6032, flag: "https://flagcdn.com/w320/lv.png" },
            { name: "Liechtenstein", capital: "Vaduz", lat: 47.166, lng: 9.5554, flag: "https://flagcdn.com/w320/li.png" },
            { name: "Lituanie", capital: "Vilnius", lat: 55.1694, lng: 23.8813, flag: "https://flagcdn.com/w320/lt.png" },
            { name: "Luxembourg", capital: "Luxembourg", lat: 49.8153, lng: 6.1296, flag: "https://flagcdn.com/w320/lu.png" },
            { name: "Mac√©doine du Nord", capital: "Skopje", lat: 41.6086, lng: 21.7453, flag: "https://flagcdn.com/w320/mk.png" },
            { name: "Malte", capital: "La Valette", lat: 35.9375, lng: 14.3754, flag: "https://flagcdn.com/w320/mt.png" },
            { name: "Moldavie", capital: "Chisinau", lat: 47.4116, lng: 28.3699, flag: "https://flagcdn.com/w320/md.png" },
            { name: "Monaco", capital: "Monaco", lat: 43.7384, lng: 7.4246, flag: "https://flagcdn.com/w320/mc.png" },
            { name: "Mont√©n√©gro", capital: "Podgorica", lat: 42.7087, lng: 19.3744, flag: "https://flagcdn.com/w320/me.png" },
            { name: "Norv√®ge", capital: "Oslo", lat: 60.472, lng: 8.4689, flag: "https://flagcdn.com/w320/no.png" },
            { name: "Pays-Bas", capital: "Amsterdam", lat: 52.1326, lng: 5.2913, flag: "https://flagcdn.com/w320/nl.png" },
            { name: "Pologne", capital: "Varsovie", lat: 51.9194, lng: 19.1451, flag: "https://flagcdn.com/w320/pl.png" },
            { name: "Portugal", capital: "Lisbonne", lat: 39.3999, lng: -8.2245, flag: "https://flagcdn.com/w320/pt.png" },
            { name: "R√©publique tch√®que", capital: "Prague", lat: 49.8175, lng: 15.4730, flag: "https://flagcdn.com/w320/cz.png" },
            { name: "Roumanie", capital: "Bucarest", lat: 45.9432, lng: 24.9668, flag: "https://flagcdn.com/w320/ro.png" },
            { name: "Royaume-Uni", capital: "Londres", lat: 55.3781, lng: -3.436, flag: "https://flagcdn.com/w320/gb.png" },
            { name: "Russie", capital: "Moscou", lat: 61.524, lng: 105.3188, flag: "https://flagcdn.com/w320/ru.png" },
            { name: "Saint-Marin", capital: "Saint-Marin", lat: 43.9424, lng: 12.4578, flag: "https://flagcdn.com/w320/sm.png" },
            { name: "Serbie", capital: "Belgrade", lat: 44.0165, lng: 21.0059, flag: "https://flagcdn.com/w320/rs.png" },
            { name: "Slovaquie", capital: "Bratislava", lat: 48.669, lng: 19.699, flag: "https://flagcdn.com/w320/sk.png" },
            { name: "Slov√©nie", capital: "Ljubljana", lat: 46.1512, lng: 14.9955, flag: "https://flagcdn.com/w320/si.png" },
            { name: "Su√®de", capital: "Stockholm", lat: 60.1282, lng: 18.6435, flag: "https://flagcdn.com/w320/se.png" },
            { name: "Suisse", capital: "Berne", lat: 46.8182, lng: 8.2275, flag: "https://flagcdn.com/w320/ch.png" },
            { name: "Ukraine", capital: "Kiev", lat: 48.3794, lng: 31.1656, flag: "https://flagcdn.com/w320/ua.png" },
            { name: "Vatican", capital: "Cit√© du Vatican", lat: 41.9029, lng: 12.4534, flag: "https://flagcdn.com/w320/va.png" },

            // Asie
            { name: "Afghanistan", capital: "Kaboul", lat: 33.9391, lng: 67.7100, flag: "https://flagcdn.com/w320/af.png" },
            { name: "Arabie saoudite", capital: "Riyad", lat: 23.8859, lng: 45.0792, flag: "https://flagcdn.com/w320/sa.png" },
            { name: "Arm√©nie", capital: "Erevan", lat: 40.0691, lng: 45.0382, flag: "https://flagcdn.com/w320/am.png" },
            { name: "Azerba√Ødjan", capital: "Bakou", lat: 40.1431, lng: 47.5769, flag: "https://flagcdn.com/w320/az.png" },
            { name: "Bahre√Øn", capital: "Manama", lat: 26.0667, lng: 50.5577, flag: "https://flagcdn.com/w320/bh.png" },
            { name: "Bangladesh", capital: "Dacca", lat: 23.685, lng: 90.3563, flag: "https://flagcdn.com/w320/bd.png" },
            { name: "Bhoutan", capital: "Thimphou", lat: 27.5142, lng: 90.4336, flag: "https://flagcdn.com/w320/bt.png" },
            { name: "Birmanie (Myanmar)", capital: "Naypyidaw", lat: 21.9162, lng: 95.9560, flag: "https://flagcdn.com/w320/mm.png" },
            { name: "Brunei", capital: "Bandar Seri Begawan", lat: 4.5353, lng: 114.7277, flag: "https://flagcdn.com/w320/bn.png" },
            { name: "Cambodge", capital: "Phnom Penh", lat: 12.5657, lng: 104.9910, flag: "https://flagcdn.com/w320/kh.png" },
            { name: "Chine", capital: "P√©kin", lat: 35.8617, lng: 104.1954, flag: "https://flagcdn.com/w320/cn.png" },
            { name: "Cor√©e du Nord", capital: "Pyongyang", lat: 40.3399, lng: 127.5101, flag: "https://flagcdn.com/w320/kp.png" },
            { name: "Cor√©e du Sud", capital: "S√©oul", lat: 35.9078, lng: 127.7669, flag: "https://flagcdn.com/w320/kr.png" },
            { name: "√âmirats arabes unis", capital: "Abou Dabi", lat: 23.4241, lng: 53.8478, flag: "https://flagcdn.com/w320/ae.png" },
            { name: "G√©orgie", capital: "Tbilissi", lat: 42.3154, lng: 43.3569, flag: "https://flagcdn.com/w320/ge.png" },
            { name: "Inde", capital: "New Delhi", lat: 20.5937, lng: 78.9629, flag: "https://flagcdn.com/w320/in.png" },
            { name: "Indon√©sie", capital: "Jakarta", lat: -0.7893, lng: 113.9213, flag: "https://flagcdn.com/w320/id.png" },
            { name: "Irak", capital: "Bagdad", lat: 33.2232, lng: 43.6793, flag: "https://flagcdn.com/w320/iq.png" },
            { name: "Iran", capital: "T√©h√©ran", lat: 32.4279, lng: 53.6880, flag: "https://flagcdn.com/w320/ir.png" },
            { name: "Isra√´l", capital: "J√©rusalem", lat: 31.0461, lng: 34.8516, flag: "https://flagcdn.com/w320/il.png" },
            { name: "Japon", capital: "Tokyo", lat: 36.2048, lng: 138.2529, flag: "https://flagcdn.com/w320/jp.png" },
            { name: "Jordanie", capital: "Amman", lat: 30.5852, lng: 36.2384, flag: "https://flagcdn.com/w320/jo.png" },
            { name: "Kazakhstan", capital: "Noursoultan", lat: 48.0196, lng: 66.9237, flag: "https://flagcdn.com/w320/kz.png" },
            { name: "Kirghizistan", capital: "Bichkek", lat: 41.2044, lng: 74.7661, flag: "https://flagcdn.com/w320/kg.png" },
            { name: "Kowe√Øt", capital: "Kowe√Øt", lat: 29.3117, lng: 47.4818, flag: "https://flagcdn.com/w320/kw.png" },
            { name: "Laos", capital: "Vientiane", lat: 19.8563, lng: 102.4955, flag: "https://flagcdn.com/w320/la.png" },
            { name: "Liban", capital: "Beyrouth", lat: 33.8547, lng: 35.8623, flag: "https://flagcdn.com/w320/lb.png" },
            { name: "Malaisie", capital: "Kuala Lumpur", lat: 4.2105, lng: 101.9758, flag: "https://flagcdn.com/w320/my.png" },
            { name: "Maldives", capital: "Mal√©", lat: 3.2028, lng: 73.2207, flag: "https://flagcdn.com/w320/mv.png" },
            { name: "Mongolie", capital: "Oulan-Bator", lat: 46.8625, lng: 103.8467, flag: "https://flagcdn.com/w320/mn.png" },
            { name: "N√©pal", capital: "Katmandou", lat: 28.3949, lng: 84.1240, flag: "https://flagcdn.com/w320/np.png" },
            { name: "Oman", capital: "Mascate", lat: 21.4735, lng: 55.9754, flag: "https://flagcdn.com/w320/om.png" },
            { name: "Ouzb√©kistan", capital: "Tachkent", lat: 41.3775, lng: 64.5853, flag: "https://flagcdn.com/w320/uz.png" },
            { name: "Pakistan", capital: "Islamabad", lat: 30.3753, lng: 69.3451, flag: "https://flagcdn.com/w320/pk.png" },
            { name: "Palestine", capital: "J√©rusalem-Est", lat: 31.9522, lng: 35.2332, flag: "https://flagcdn.com/w320/ps.png" },
            { name: "Philippines", capital: "Manille", lat: 12.8797, lng: 121.7740, flag: "https://flagcdn.com/w320/ph.png" },
            { name: "Qatar", capital: "Doha", lat: 25.3548, lng: 51.1839, flag: "https://flagcdn.com/w320/qa.png" },
            { name: "Singapour", capital: "Singapour", lat: 1.3521, lng: 103.8198, flag: "https://flagcdn.com/w320/sg.png" },
            { name: "Sri Lanka", capital: "Sri Jayawardenapura Kotte", lat: 7.8731, lng: 80.7718, flag: "https://flagcdn.com/w320/lk.png" },
            { name: "Syrie", capital: "Damas", lat: 34.8021, lng: 38.9968, flag: "https://flagcdn.com/w320/sy.png" },
            { name: "Tadjikistan", capital: "Douchanb√©", lat: 38.8610, lng: 71.2761, flag: "https://flagcdn.com/w320/tj.png" },
            { name: "Tha√Ølande", capital: "Bangkok", lat: 15.8700, lng: 100.9925, flag: "https://flagcdn.com/w320/th.png" },
            { name: "Timor oriental", capital: "Dili", lat: -8.8742, lng: 125.7275, flag: "https://flagcdn.com/w320/tl.png" },
            { name: "Turkm√©nistan", capital: "Achgabat", lat: 38.9697, lng: 59.5563, flag: "https://flagcdn.com/w320/tm.png" },
            { name: "Turquie", capital: "Ankara", lat: 38.9637, lng: 35.2433, flag: "https://flagcdn.com/w320/tr.png" },
            { name: "Vietnam", capital: "Hano√Ø", lat: 14.0583, lng: 108.2772, flag: "https://flagcdn.com/w320/vn.png" },
            { name: "Y√©men", capital: "Sanaa", lat: 15.5527, lng: 48.5164, flag: "https://flagcdn.com/w320/ye.png" },

            // Afrique
            { name: "Afrique du Sud", capital: "Pretoria", lat: -30.5595, lng: 22.9375, flag: "https://flagcdn.com/w320/za.png" },
            { name: "Alg√©rie", capital: "Alger", lat: 28.0339, lng: 1.6596, flag: "https://flagcdn.com/w320/dz.png" },
            { name: "Angola", capital: "Luanda", lat: -11.2027, lng: 17.8739, flag: "https://flagcdn.com/w320/ao.png" },
            { name: "B√©nin", capital: "Porto-Novo", lat: 9.3077, lng: 2.3158, flag: "https://flagcdn.com/w320/bj.png" },
            { name: "Botswana", capital: "Gaborone", lat: -22.3285, lng: 24.6849, flag: "https://flagcdn.com/w320/bw.png" },
            { name: "Burkina Faso", capital: "Ouagadougou", lat: 12.2383, lng: -1.5616, flag: "https://flagcdn.com/w320/bf.png" },
            { name: "Burundi", capital: "Gitega", lat: -3.3731, lng: 29.9189, flag: "https://flagcdn.com/w320/bi.png" },
            { name: "Cameroun", capital: "Yaound√©", lat: 7.3697, lng: 12.3547, flag: "https://flagcdn.com/w320/cm.png" },
            { name: "Cap-Vert", capital: "Praia", lat: 16.5388, lng: -23.0418, flag: "https://flagcdn.com/w320/cv.png" },
            { name: "Centrafrique", capital: "Bangui", lat: 6.6111, lng: 20.9394, flag: "https://flagcdn.com/w320/cf.png" },
            { name: "Comores", capital: "Moroni", lat: -11.8750, lng: 43.8722, flag: "https://flagcdn.com/w320/km.png" },
            { name: "Congo (Brazzaville)", capital: "Brazzaville", lat: -0.2280, lng: 15.8277, flag: "https://flagcdn.com/w320/cg.png" },
            { name: "Congo (RDC)", capital: "Kinshasa", lat: -4.0383, lng: 21.7587, flag: "https://flagcdn.com/w320/cd.png" },
            { name: "C√¥te d'Ivoire", capital: "Yamoussoukro", lat: 7.5400, lng: -5.5471, flag: "https://flagcdn.com/w320/ci.png" },
            { name: "Djibouti", capital: "Djibouti", lat: 11.8251, lng: 42.5903, flag: "https://flagcdn.com/w320/dj.png" },
            { name: "√âgypte", capital: "Le Caire", lat: 26.8206, lng: 30.8025, flag: "https://flagcdn.com/w320/eg.png" },
            { name: "√ârythr√©e", capital: "Asmara", lat: 15.1794, lng: 39.7823, flag: "https://flagcdn.com/w320/er.png" },
            { name: "Eswatini", capital: "Mbabane", lat: -26.5225, lng: 31.4659, flag: "https://flagcdn.com/w320/sz.png" },
            { name: "√âthiopie", capital: "Addis-Abeba", lat: 9.1450, lng: 40.4897, flag: "https://flagcdn.com/w320/et.png" },
            { name: "Gabon", capital: "Libreville", lat: -0.8037, lng: 11.6094, flag: "https://flagcdn.com/w320/ga.png" },
            { name: "Gambie", capital: "Banjul", lat: 13.4432, lng: -15.3101, flag: "https://flagcdn.com/w320/gm.png" },
            { name: "Ghana", capital: "Accra", lat: 7.9465, lng: -1.0232, flag: "https://flagcdn.com/w320/gh.png" },
            { name: "Guin√©e", capital: "Conakry", lat: 9.9456, lng: -9.6966, flag: "https://flagcdn.com/w320/gn.png" },
            { name: "Guin√©e-Bissau", capital: "Bissau", lat: 11.8037, lng: -15.1804, flag: "https://flagcdn.com/w320/gw.png" },
            { name: "Guin√©e √©quatoriale", capital: "Malabo", lat: 1.6508, lng: 10.2679, flag: "https://flagcdn.com/w320/gq.png" },
            { name: "Kenya", capital: "Nairobi", lat: -0.0236, lng: 37.9062, flag: "https://flagcdn.com/w320/ke.png" },
            { name: "Lesotho", capital: "Maseru", lat: -29.6100, lng: 28.2336, flag: "https://flagcdn.com/w320/ls.png" },
            { name: "Liberia", capital: "Monrovia", lat: 6.4281, lng: -9.4295, flag: "https://flagcdn.com/w320/lr.png" },
            { name: "Libye", capital: "Tripoli", lat: 26.3351, lng: 17.2283, flag: "https://flagcdn.com/w320/ly.png" },
            { name: "Madagascar", capital: "Antananarivo", lat: -18.7669, lng: 46.8691, flag: "https://flagcdn.com/w320/mg.png" },
            { name: "Malawi", capital: "Lilongwe", lat: -13.2543, lng: 34.3015, flag: "https://flagcdn.com/w320/mw.png" },
            { name: "Mali", capital: "Bamako", lat: 17.5707, lng: -3.9962, flag: "https://flagcdn.com/w320/ml.png" },
            { name: "Maroc", capital: "Rabat", lat: 31.7917, lng: -7.0926, flag: "https://flagcdn.com/w320/ma.png" },
            { name: "Maurice", capital: "Port-Louis", lat: -20.3484, lng: 57.5522, flag: "https://flagcdn.com/w320/mu.png" },
            { name: "Mauritanie", capital: "Nouakchott", lat: 21.0079, lng: -10.9408, flag: "https://flagcdn.com/w320/mr.png" },
            { name: "Mozambique", capital: "Maputo", lat: -18.6657, lng: 35.5296, flag: "https://flagcdn.com/w320/mz.png" },
            { name: "Namibie", capital: "Windhoek", lat: -22.9576, lng: 18.4904, flag: "https://flagcdn.com/w320/na.png" },
            { name: "Niger", capital: "Niamey", lat: 17.6078, lng: 8.0817, flag: "https://flagcdn.com/w320/ne.png" },
            { name: "Nigeria", capital: "Abuja", lat: 9.0820, lng: 8.6753, flag: "https://flagcdn.com/w320/ng.png" },
            { name: "Ouganda", capital: "Kampala", lat: 1.3733, lng: 32.2903, flag: "https://flagcdn.com/w320/ug.png" },
            { name: "Rwanda", capital: "Kigali", lat: -1.9403, lng: 29.8739, flag: "https://flagcdn.com/w320/rw.png" },
            { name: "Sao Tom√©-et-Principe", capital: "Sao Tom√©", lat: 0.1864, lng: 6.6131, flag: "https://flagcdn.com/w320/st.png" },
            { name: "S√©n√©gal", capital: "Dakar", lat: 14.4974, lng: -14.4524, flag: "https://flagcdn.com/w320/sn.png" },
            { name: "Seychelles", capital: "Victoria", lat: -4.6796, lng: 55.4920, flag: "https://flagcdn.com/w320/sc.png" },
            { name: "Sierra Leone", capital: "Freetown", lat: 8.4606, lng: -11.7799, flag: "https://flagcdn.com/w320/sl.png" },
            { name: "Somalie", capital: "Mogadiscio", lat: 5.1521, lng: 46.1996, flag: "https://flagcdn.com/w320/so.png" },
            { name: "Soudan", capital: "Khartoum", lat: 12.8628, lng: 30.2176, flag: "https://flagcdn.com/w320/sd.png" },
            { name: "Soudan du Sud", capital: "Djouba", lat: 6.8770, lng: 31.3070, flag: "https://flagcdn.com/w320/ss.png" },
            { name: "Tanzanie", capital: "Dodoma", lat: -6.3690, lng: 34.8888, flag: "https://flagcdn.com/w320/tz.png" },
            { name: "Tchad", capital: "N'Djam√©na", lat: 15.4542, lng: 18.7322, flag: "https://flagcdn.com/w320/td.png" },
            { name: "Togo", capital: "Lom√©", lat: 8.6195, lng: 0.8248, flag: "https://flagcdn.com/w320/tg.png" },
            { name: "Tunisie", capital: "Tunis", lat: 33.8869, lng: 9.5375, flag: "https://flagcdn.com/w320/tn.png" },
            { name: "Zambie", capital: "Lusaka", lat: -13.1339, lng: 27.8493, flag: "https://flagcdn.com/w320/zm.png" },
            { name: "Zimbabwe", capital: "Harare", lat: -19.0154, lng: 29.1549, flag: "https://flagcdn.com/w320/zw.png" },

            // Am√©riques
            { name: "Antigua-et-Barbuda", capital: "Saint John's", lat: 17.0608, lng: -61.7964, flag: "https://flagcdn.com/w320/ag.png" },
            { name: "Argentine", capital: "Buenos Aires", lat: -38.4161, lng: -63.6167, flag: "https://flagcdn.com/w320/ar.png" },
            { name: "Bahamas", capital: "Nassau", lat: 25.0343, lng: -77.3963, flag: "https://flagcdn.com/w320/bs.png" },
            { name: "Barbade", capital: "Bridgetown", lat: 13.1939, lng: -59.5432, flag: "https://flagcdn.com/w320/bb.png" },
            { name: "Belize", capital: "Belmopan", lat: 17.1899, lng: -88.4976, flag: "https://flagcdn.com/w320/bz.png" },
            { name: "Bolivie", capital: "La Paz", lat: -16.2902, lng: -63.5887, flag: "https://flagcdn.com/w320/bo.png" },
            { name: "Br√©sil", capital: "Bras√≠lia", lat: -14.2350, lng: -51.9253, flag: "https://flagcdn.com/w320/br.png" },
            { name: "Canada", capital: "Ottawa", lat: 56.1304, lng: -106.3468, flag: "https://flagcdn.com/w320/ca.png" },
            { name: "Chili", capital: "Santiago", lat: -35.6751, lng: -71.5430, flag: "https://flagcdn.com/w320/cl.png" },
            { name: "Colombie", capital: "Bogota", lat: 4.5709, lng: -74.2973, flag: "https://flagcdn.com/w320/co.png" },
            { name: "Costa Rica", capital: "San Jos√©", lat: 9.7489, lng: -83.7534, flag: "https://flagcdn.com/w320/cr.png" },
            { name: "Cuba", capital: "La Havane", lat: 21.5218, lng: -77.7812, flag: "https://flagcdn.com/w320/cu.png" },
            { name: "Dominique", capital: "Roseau", lat: 15.4150, lng: -61.3710, flag: "https://flagcdn.com/w320/dm.png" },
            { name: "√âquateur", capital: "Quito", lat: -1.8312, lng: -78.1834, flag: "https://flagcdn.com/w320/ec.png" },
            { name: "√âtats-Unis", capital: "Washington D.C.", lat: 37.0902, lng: -95.7129, flag: "https://flagcdn.com/w320/us.png" },
            { name: "Grenade", capital: "Saint-Georges", lat: 12.1165, lng: -61.6790, flag: "https://flagcdn.com/w320/gd.png" },
            { name: "Guatemala", capital: "Guatemala", lat: 15.7835, lng: -90.2308, flag: "https://flagcdn.com/w320/gt.png" },
            { name: "Guyana", capital: "Georgetown", lat: 4.8604, lng: -58.9302, flag: "https://flagcdn.com/w320/gy.png" },
            { name: "Ha√Øti", capital: "Port-au-Prince", lat: 18.9712, lng: -72.2852, flag: "https://flagcdn.com/w320/ht.png" },
            { name: "Honduras", capital: "Tegucigalpa", lat: 15.2000, lng: -86.2419, flag: "https://flagcdn.com/w320/hn.png" },
            { name: "Jama√Øque", capital: "Kingston", lat: 18.1096, lng: -77.2975, flag: "https://flagcdn.com/w320/jm.png" },
            { name: "Mexique", capital: "Mexico", lat: 23.6345, lng: -102.5528, flag: "https://flagcdn.com/w320/mx.png" },
            { name: "Nicaragua", capital: "Managua", lat: 12.8654, lng: -85.2072, flag: "https://flagcdn.com/w320/ni.png" },
            { name: "Panama", capital: "Panama", lat: 8.5380, lng: -80.7821, flag: "https://flagcdn.com/w320/pa.png" },
            { name: "Paraguay", capital: "Asuncion", lat: -23.4425, lng: -58.4438, flag: "https://flagcdn.com/w320/py.png" },
            { name: "P√©rou", capital: "Lima", lat: -9.1900, lng: -75.0152, flag: "https://flagcdn.com/w320/pe.png" },
            { name: "R√©publique dominicaine", capital: "Saint-Domingue", lat: 18.7357, lng: -70.1627, flag: "https://flagcdn.com/w320/do.png" },
            { name: "Saint-Christophe-et-Ni√©v√®s", capital: "Basseterre", lat: 17.3578, lng: -62.7830, flag: "https://flagcdn.com/w320/kn.png" },
            { name: "Sainte-Lucie", capital: "Castries", lat: 13.9094, lng: -60.9789, flag: "https://flagcdn.com/w320/lc.png" },
            { name: "Saint-Vincent-et-les-Grenadines", capital: "Kingstown", lat: 12.9843, lng: -61.2872, flag: "https://flagcdn.com/w320/vc.png" },
            { name: "Salvador", capital: "San Salvador", lat: 13.7942, lng: -88.8965, flag: "https://flagcdn.com/w320/sv.png" },
            { name: "Suriname", capital: "Paramaribo", lat: 3.9193, lng: -56.0278, flag: "https://flagcdn.com/w320/sr.png" },
            { name: "Trinit√©-et-Tobago", capital: "Port-d'Espagne", lat: 10.6918, lng: -61.2225, flag: "https://flagcdn.com/w320/tt.png" },
            { name: "Uruguay", capital: "Montevideo", lat: -32.5228, lng: -55.7658, flag: "https://flagcdn.com/w320/uy.png" },
            { name: "Venezuela", capital: "Caracas", lat: 6.4238, lng: -66.5897, flag: "https://flagcdn.com/w320/ve.png" },

            // Oc√©anie
            { name: "Australie", capital: "Canberra", lat: -25.2744, lng: 133.7751, flag: "https://flagcdn.com/w320/au.png" },
            { name: "Fidji", capital: "Suva", lat: -17.7134, lng: 178.0650, flag: "https://flagcdn.com/w320/fj.png" },
            { name: "Kiribati", capital: "Tarawa-Sud", lat: -3.3704, lng: -168.7340, flag: "https://flagcdn.com/w320/ki.png" },
            { name: "Marshall", capital: "Majuro", lat: 7.1315, lng: 171.1845, flag: "https://flagcdn.com/w320/mh.png" },
            { name: "Micron√©sie", capital: "Palikir", lat: 7.4256, lng: 150.5508, flag: "https://flagcdn.com/w320/fm.png" },
            { name: "Nauru", capital: "Yaren", lat: -0.5228, lng: 166.9315, flag: "https://flagcdn.com/w320/nr.png" },
            { name: "Nouvelle-Z√©lande", capital: "Wellington", lat: -40.9006, lng: 174.8860, flag: "https://flagcdn.com/w320/nz.png" },
            { name: "Palaos", capital: "Melekeok", lat: 7.5150, lng: 134.5825, flag: "https://flagcdn.com/w320/pw.png" },
            { name: "Papouasie-Nouvelle-Guin√©e", capital: "Port Moresby", lat: -6.3150, lng: 143.9555, flag: "https://flagcdn.com/w320/pg.png" },
            { name: "Salomon", capital: "Honiara", lat: -9.6457, lng: 160.1562, flag: "https://flagcdn.com/w320/sb.png" },
            { name: "Samoa", capital: "Apia", lat: -13.7590, lng: -172.1046, flag: "https://flagcdn.com/w320/ws.png" },
            { name: "Tonga", capital: "Nuku'alofa", lat: -21.1790, lng: -175.1982, flag: "https://flagcdn.com/w320/to.png" },
            { name: "Tuvalu", capital: "Funafuti", lat: -7.1095, lng: 177.6493, flag: "https://flagcdn.com/w320/tv.png" },
            { name: "Vanuatu", capital: "Port-Vila", lat: -15.3767, lng: 166.9592, flag: "https://flagcdn.com/w320/vu.png" }
        ];

        // Game State
        let currentState = {
            mode: null,
            score: 0,
            round: 0,
            maxRounds: 10,
            currentQuestion: null,
            isAnswering: false
        };

        // Map Instance
        let map = null;
        let currentMarker = null;

        // DOM Elements
        const screens = {
            menu: document.getElementById('menu-screen'),
            game: document.getElementById('game-screen')
        };

        const ui = {
            questionText: document.getElementById('question-text'),
            questionContent: document.getElementById('question-content'),
            optionsGrid: document.getElementById('options-grid'),
            mapContainer: document.getElementById('map-container'),
            scoreBoard: document.getElementById('score-board'),
            currentScore: document.getElementById('current-score'),
            totalQuestions: document.getElementById('total-questions'),
            exitBtn: document.getElementById('exit-btn'),
            feedback: document.getElementById('feedback')
        };

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Menu Buttons
            document.querySelectorAll('.menu-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const mode = btn.dataset.mode;
                    startGame(mode);
                });
            });

            ui.exitBtn.addEventListener('click', () => {
                showScreen('menu');
                ui.exitBtn.classList.add('hidden');
                ui.scoreBoard.classList.add('hidden');
            });
        });

        function showScreen(screenName) {
            Object.values(screens).forEach(s => s.classList.remove('active'));
            screens[screenName].classList.add('active');
        }

        function startGame(mode) {
            currentState.mode = mode;
            currentState.score = 0;
            currentState.round = 0;

            ui.currentScore.innerText = 0;
            ui.totalQuestions.innerText = currentState.maxRounds;

            ui.scoreBoard.classList.remove('hidden');
            ui.exitBtn.classList.remove('hidden');

            showScreen('game');

            // Setup UI based on mode
            if (mode === 'map') {
                ui.optionsGrid.classList.add('hidden');
                ui.mapContainer.classList.remove('hidden');
                initMap();
            } else {
                ui.optionsGrid.classList.remove('hidden');
                ui.mapContainer.classList.add('hidden');
            }

            nextQuestion();
        }

        function nextQuestion() {
            if (currentState.round >= currentState.maxRounds) {
                endGame();
                return;
            }

            currentState.round++;
            currentState.isAnswering = false;
            ui.feedback.classList.add('hidden');
            ui.feedback.innerText = '';

            // Pick a random country
            const country = countries[Math.floor(Math.random() * countries.length)];
            currentState.currentQuestion = country;

            renderQuestion(country);
        }

        function renderQuestion(country) {
            ui.questionContent.innerHTML = ''; // Clear previous content

            if (currentState.mode === 'flags') {
                ui.questionText.innerText = "De quel pays est ce drapeau ?";
                ui.questionContent.innerHTML = `<img src="${country.flag}" alt="Drapeau">`;
                generateOptions(country, 'name');
            }
            else if (currentState.mode === 'capitals') {
                const isReverse = Math.random() > 0.5; // Randomly ask "Capital of X?" or "X is capital of?"
                if (isReverse) {
                    ui.questionText.innerText = `Quelle est la capitale de : ${country.name} ?`;
                    generateOptions(country, 'capital');
                } else {
                    ui.questionText.innerText = `${country.capital} est la capitale de quel pays ?`;
                    generateOptions(country, 'name');
                }
            }
            else if (currentState.mode === 'map') {
                ui.questionText.innerText = `Situez ce pays sur la carte : ${country.name}`;
                resetMap();
            }
        }

        function generateOptions(correctCountry, property) {
            ui.optionsGrid.innerHTML = '';

            // Get 3 random wrong answers
            const wrongOptions = countries
                .filter(c => c.name !== correctCountry.name)
                .sort(() => 0.5 - Math.random())
                .slice(0, 3);

            const options = [...wrongOptions, correctCountry].sort(() => 0.5 - Math.random());

            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = opt[property];
                btn.onclick = () => handleAnswer(opt, btn);
                ui.optionsGrid.appendChild(btn);
            });
        }

        function handleAnswer(selectedOption, btnElement) {
            if (currentState.isAnswering) return;
            currentState.isAnswering = true;

            const isCorrect = selectedOption.name === currentState.currentQuestion.name;

            if (isCorrect) {
                currentState.score++;
                ui.currentScore.innerText = currentState.score;
                btnElement.classList.add('correct');
                showFeedback(true, "Bravo !");
            } else {
                btnElement.classList.add('wrong');
                // Highlight correct answer
                const correctBtn = Array.from(ui.optionsGrid.children).find(b => b.innerText ===
                    (currentState.mode === 'capitals' && ui.questionText.innerText.includes('capitale de quel pays')
                        ? currentState.currentQuestion.name
                        : (currentState.mode === 'capitals' ? currentState.currentQuestion.capital : currentState.currentQuestion.name))
                );
                if (correctBtn) correctBtn.classList.add('correct');

                showFeedback(false, `Rat√© ! La r√©ponse √©tait ${currentState.currentQuestion.name}`);
            }

            setTimeout(nextQuestion, 1500);
        }

        // --- Map Logic ---
        function initMap() {
            if (!map) {
                map = L.map('map-container').setView([20, 0], 2);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '¬© OpenStreetMap contributors'
                }).addTo(map);

                map.on('click', onMapClick);
            }
            setTimeout(() => { map.invalidateSize(); }, 200); // Fix rendering issue
        }

        function resetMap() {
            if (currentMarker) {
                map.removeLayer(currentMarker);
                currentMarker = null;
            }
            map.setView([20, 0], 2);
        }

        function onMapClick(e) {
            if (currentState.isAnswering) return;
            currentState.isAnswering = true;

            const latlng = e.latlng;
            const target = currentState.currentQuestion;

            L.circleMarker(latlng, { color: 'blue', radius: 8 }).addTo(map);

            const dist = map.distance(latlng, [target.lat, target.lng]); // Dist in meters
            const distKm = Math.round(dist / 1000);
            const isCloseEnough = distKm < 800; // 800km tolerance

            // Show correct location
            currentMarker = L.marker([target.lat, target.lng]).addTo(map)
                .bindPopup(`<b>${target.name}</b>`).openPopup();

            L.polyline([latlng, [target.lat, target.lng]], { color: isCloseEnough ? 'green' : 'red' }).addTo(map);

            if (isCloseEnough) {
                currentState.score++;
                ui.currentScore.innerText = currentState.score;
                showFeedback(true, `Super ! √Ä ${distKm}km.`);
            } else {
                showFeedback(false, `Trop loin (${distKm}km).`);
            }

            setTimeout(nextQuestion, 2500);
        }

        function showFeedback(isSuccess, text) {
            ui.feedback.innerText = text;
            ui.feedback.style.color = isSuccess ? 'var(--success)' : 'var(--error)';
            ui.feedback.style.background = isSuccess ? '#e8f8f0' : '#fdedea';
            ui.feedback.classList.remove('hidden');
        }

        function endGame() {
            ui.game.innerHTML = `
        <div class="question-box">
            <h2>Partie Termin√©e !</h2>
            <p style="font-size: 3rem; margin: 2rem 0;">${currentState.score} / ${currentState.maxRounds}</p>
            <button class="btn-primary" onclick="location.reload()" 
            style="padding: 1rem 2rem; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1.2rem;">
            Rejouer
            </button>
        </div>
    `;
            ui.exitBtn.classList.add('hidden');
        }
    </script>
</body>

</html>